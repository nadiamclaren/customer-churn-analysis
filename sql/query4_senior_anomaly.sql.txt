SELECT 
    cu.SeniorCitizen,
    COUNT(*) AS total_customers,
    SUM(CASE WHEN ch.Churn = 'Yes' THEN 1 ELSE 0 END) AS churned,
    ROUND(
        SUM(CASE WHEN ch.Churn = 'Yes' THEN 1 ELSE 0 END) * 100.0 / COUNT(*),
    2) AS churn_rate_pct,
    ROUND(AVG(CAST(b.MonthlyCharges AS FLOAT)), 2) AS avg_monthly_charge
FROM customers cu
JOIN churn ch ON cu.customerID = ch.customerID
JOIN billing b ON cu.customerID = b.customerID
GROUP BY cu.SeniorCitizen;