SELECT 
    CASE 
        WHEN cu.tenure <= 12 THEN '1. 0-12 months'
        WHEN cu.tenure <= 24 THEN '2. 13-24 months'
        WHEN cu.tenure <= 48 THEN '3. 25-48 months'
        ELSE '4. 48+ months'
    END AS tenure_band,
    COUNT(*) AS total_customers,
    SUM(CASE WHEN ch.Churn = 'Yes' THEN 1 ELSE 0 END) AS churned,
    ROUND(
        SUM(CASE WHEN ch.Churn = 'Yes' THEN 1 ELSE 0 END) * 100.0 / COUNT(*),
    2) AS churn_rate_pct
FROM customers cu
JOIN churn ch ON cu.customerID = ch.customerID
GROUP BY tenure_band
ORDER BY tenure_band;